generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DATABASE_URL_UNPOOLED")
}

// ─── Auth ───────────────────────────────────────────────

enum Role {
  ADMIN
  USER
}

model User {
  id             String   @id @default(cuid())
  email          String   @unique
  name           String?
  hashedPassword String
  role           Role     @default(USER)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("users")
}

// ─── Vehicles ───────────────────────────────────────────

enum VehicleType {
  PARTY_BUS
  SPRINTER_LIMO
  STRETCH_LIMO
  SUV
}

model Vehicle {
  id           String      @id @default(cuid())
  name         String
  slug         String      @unique
  type         VehicleType
  capacity     Int
  hourlyRate   Decimal     @db.Decimal(10, 2)
  minHours     Int
  description  String
  features     String[]
  imageUrl     String?
  galleryUrls  String[]
  displayOrder Int         @default(0)
  isActive     Boolean     @default(true)
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  quotes   Quote[]
  bookings Booking[]

  @@map("vehicles")
}

// ─── Services ───────────────────────────────────────────

model Service {
  id              String   @id @default(cuid())
  title           String
  slug            String   @unique
  tagline         String
  description     String
  longDescription String   @db.Text
  icon            String
  keywords        String
  imageUrl        String?
  displayOrder    Int      @default(0)
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())

  @@map("services")
}

// ─── Testimonials ───────────────────────────────────────

model Testimonial {
  id         String   @id @default(cuid())
  name       String
  eventType  String?
  rating     Int      @default(5)
  text       String
  isFeatured Boolean  @default(false)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())

  @@map("testimonials")
}

// ─── Quotes ─────────────────────────────────────────────

enum QuoteStatus {
  NEW
  CONTACTED
  QUOTED
  BOOKED
  COMPLETED
  CANCELLED
}

model Quote {
  id                 String      @id @default(cuid())
  name               String
  email              String
  phone              String
  eventType          String
  preferredVehicleId String?
  preferredVehicle   Vehicle?    @relation(fields: [preferredVehicleId], references: [id], onDelete: SetNull)
  eventDate          String
  pickupTime         String?
  guestCount         Int?
  durationHours      Int?
  pickupLocation     String?
  dropoffLocation    String?
  details            String?     @db.Text
  status             QuoteStatus @default(NEW)
  quotedAmount       Decimal?    @db.Decimal(10, 2)
  adminNotes         String?     @db.Text
  createdAt          DateTime    @default(now())
  updatedAt          DateTime    @updatedAt

  bookings Booking[]

  @@map("quotes")
}

// ─── Bookings ───────────────────────────────────────────

enum BookingStatus {
  PENDING
  CONFIRMED
  DEPOSIT_PAID
  IN_PROGRESS
  COMPLETED
  CANCELLED
}

model Booking {
  id              String        @id @default(cuid())
  quoteId         String?
  quote           Quote?        @relation(fields: [quoteId], references: [id], onDelete: SetNull)
  clientName      String
  clientEmail     String?
  clientPhone     String?
  eventType       String
  vehicleId       String?
  vehicle         Vehicle?      @relation(fields: [vehicleId], references: [id], onDelete: SetNull)
  bookingDate     String
  startTime       String
  endTime         String?
  durationHours   Int?
  pickupLocation  String?
  dropoffLocation String?
  guestCount      Int?
  totalAmount     Decimal?      @db.Decimal(10, 2)
  depositAmount   Decimal?      @db.Decimal(10, 2)
  depositPaid     Boolean       @default(false)
  status          BookingStatus @default(PENDING)
  notes           String?       @db.Text
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@map("bookings")
}
